Traceback (most recent call last):
  File "C:\Users\Admin\anaconda3\envs\book\lib\site-packages\jupyter_core\utils\__init__.py", line 154, in wrapped
    asyncio.get_running_loop()
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Admin\anaconda3\envs\book\lib\site-packages\jupyter_cache\executors\utils.py", line 58, in single_nb_execution
    executenb(
  File "C:\Users\Admin\anaconda3\envs\book\lib\site-packages\nbclient\client.py", line 1319, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "C:\Users\Admin\anaconda3\envs\book\lib\site-packages\jupyter_core\utils\__init__.py", line 158, in wrapped
    return loop.run_until_complete(inner)
  File "C:\Users\Admin\anaconda3\envs\book\lib\asyncio\base_events.py", line 647, in run_until_complete
    return future.result()
  File "C:\Users\Admin\anaconda3\envs\book\lib\site-packages\nbclient\client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "C:\Users\Admin\anaconda3\envs\book\lib\site-packages\nbclient\client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "C:\Users\Admin\anaconda3\envs\book\lib\site-packages\nbclient\client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
# Predict cluster for new data
new_data = np.array([[0, 0], [5, 5]])
clusters = kmeans.predict(new_data)
print("New Data Clusters:", clusters)
------------------


[1;31m---------------------------------------------------------------------------[0m
[1;31mValueError[0m                                Traceback (most recent call last)
Cell [1;32mIn[7], line 3[0m
[0;32m      1[0m [38;5;66;03m# Predict cluster for new data[39;00m
[0;32m      2[0m new_data [38;5;241m=[39m np[38;5;241m.[39marray([[[38;5;241m0[39m, [38;5;241m0[39m], [[38;5;241m5[39m, [38;5;241m5[39m]])
[1;32m----> 3[0m clusters [38;5;241m=[39m [43mkmeans[49m[38;5;241;43m.[39;49m[43mpredict[49m[43m([49m[43mnew_data[49m[43m)[49m
[0;32m      4[0m [38;5;28mprint[39m([38;5;124m"[39m[38;5;124mNew Data Clusters:[39m[38;5;124m"[39m, clusters)

File [1;32m~\anaconda3\envs\book\lib\site-packages\sklearn\cluster\_kmeans.py:1085[0m, in [0;36m_BaseKMeans.predict[1;34m(self, X)[0m
[0;32m   1067[0m [38;5;250m[39m[38;5;124;03m"""Predict the closest cluster each sample in X belongs to.[39;00m
[0;32m   1068[0m 
[0;32m   1069[0m [38;5;124;03mIn the vector quantization literature, `cluster_centers_` is called[39;00m
[1;32m   (...)[0m
[0;32m   1081[0m [38;5;124;03m    Index of the cluster each sample belongs to.[39;00m
[0;32m   1082[0m [38;5;124;03m"""[39;00m
[0;32m   1083[0m check_is_fitted([38;5;28mself[39m)
[1;32m-> 1085[0m X [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_check_test_data[49m[43m([49m[43mX[49m[43m)[49m
[0;32m   1087[0m [38;5;66;03m# sample weights are not used by predict but cython helpers expect an array[39;00m
[0;32m   1088[0m sample_weight [38;5;241m=[39m np[38;5;241m.[39mones(X[38;5;241m.[39mshape[[38;5;241m0[39m], dtype[38;5;241m=[39mX[38;5;241m.[39mdtype)

File [1;32m~\anaconda3\envs\book\lib\site-packages\sklearn\cluster\_kmeans.py:944[0m, in [0;36m_BaseKMeans._check_test_data[1;34m(self, X)[0m
[0;32m    943[0m [38;5;28;01mdef[39;00m[38;5;250m [39m[38;5;21m_check_test_data[39m([38;5;28mself[39m, X):
[1;32m--> 944[0m     X [38;5;241m=[39m [43mvalidate_data[49m[43m([49m
[0;32m    945[0m [43m        [49m[38;5;28;43mself[39;49m[43m,[49m
[0;32m    946[0m [43m        [49m[43mX[49m[43m,[49m
[0;32m    947[0m [43m        [49m[43maccept_sparse[49m[38;5;241;43m=[39;49m[38;5;124;43m"[39;49m[38;5;124;43mcsr[39;49m[38;5;124;43m"[39;49m[43m,[49m
[0;32m    948[0m [43m        [49m[43mreset[49m[38;5;241;43m=[39;49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m
[0;32m    949[0m [43m        [49m[43mdtype[49m[38;5;241;43m=[39;49m[43m[[49m[43mnp[49m[38;5;241;43m.[39;49m[43mfloat64[49m[43m,[49m[43m [49m[43mnp[49m[38;5;241;43m.[39;49m[43mfloat32[49m[43m][49m[43m,[49m
[0;32m    950[0m [43m        [49m[43morder[49m[38;5;241;43m=[39;49m[38;5;124;43m"[39;49m[38;5;124;43mC[39;49m[38;5;124;43m"[39;49m[43m,[49m
[0;32m    951[0m [43m        [49m[43maccept_large_sparse[49m[38;5;241;43m=[39;49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m
[0;32m    952[0m [43m    [49m[43m)[49m
[0;32m    953[0m     [38;5;28;01mreturn[39;00m X

File [1;32m~\anaconda3\envs\book\lib\site-packages\sklearn\utils\validation.py:2965[0m, in [0;36mvalidate_data[1;34m(_estimator, X, y, reset, validate_separately, skip_check_array, **check_params)[0m
[0;32m   2962[0m     out [38;5;241m=[39m X, y
[0;32m   2964[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m no_val_X [38;5;129;01mand[39;00m check_params[38;5;241m.[39mget([38;5;124m"[39m[38;5;124mensure_2d[39m[38;5;124m"[39m, [38;5;28;01mTrue[39;00m):
[1;32m-> 2965[0m     [43m_check_n_features[49m[43m([49m[43m_estimator[49m[43m,[49m[43m [49m[43mX[49m[43m,[49m[43m [49m[43mreset[49m[38;5;241;43m=[39;49m[43mreset[49m[43m)[49m
[0;32m   2967[0m [38;5;28;01mreturn[39;00m out

File [1;32m~\anaconda3\envs\book\lib\site-packages\sklearn\utils\validation.py:2829[0m, in [0;36m_check_n_features[1;34m(estimator, X, reset)[0m
[0;32m   2826[0m     [38;5;28;01mreturn[39;00m
[0;32m   2828[0m [38;5;28;01mif[39;00m n_features [38;5;241m!=[39m estimator[38;5;241m.[39mn_features_in_:
[1;32m-> 2829[0m     [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m(
[0;32m   2830[0m         [38;5;124mf[39m[38;5;124m"[39m[38;5;124mX has [39m[38;5;132;01m{[39;00mn_features[38;5;132;01m}[39;00m[38;5;124m features, but [39m[38;5;132;01m{[39;00mestimator[38;5;241m.[39m[38;5;18m__class__[39m[38;5;241m.[39m[38;5;18m__name__[39m[38;5;132;01m}[39;00m[38;5;124m [39m[38;5;124m"[39m
[0;32m   2831[0m         [38;5;124mf[39m[38;5;124m"[39m[38;5;124mis expecting [39m[38;5;132;01m{[39;00mestimator[38;5;241m.[39mn_features_in_[38;5;132;01m}[39;00m[38;5;124m features as input.[39m[38;5;124m"[39m
[0;32m   2832[0m     )

[1;31mValueError[0m: X has 2 features, but KMeans is expecting 4 features as input.

